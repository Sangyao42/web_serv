<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Subscribe</title>
</head>

<body>
  <form id="subscribe" method="post" onsubmit="handleSubscription(event)">
    <div>
      <label for="email">Enter your email: </label>
      <input type="email" name="email" id="email" required />
    </div>
    <div>
      <input type="submit" value="Subscribe!" />
    </div>
  </form>
  <div id="result"></div>
</body>
<script>
  function handleSubscription(event) {
    event.preventDefault();

    const formData = new FormData(document.getElementById("subscribe"));

    fetch("http://localhost:8080/subscribe/subscribe.php", {
      method: 'POST',
      body: formData
    })
    .then(response => {
      if (!response.ok) {
        throw new Error("Network response was not ok " + response.statusText);
      }
      return response.json();
    })
    .then(data => {
      console.log("Response:", data);
    })
    .catch(error => {
      console.log("Error:", error);
      document.getElementById('result').innerText = "An error occurred: " + error.message;
    })
  }
</script>

</html>


<script>
  function handleSubscription(event) {
    event.preventDefault(); // Prevent the default form submission

    const formData = new FormData(document.getElementById("subscribe"));

    fetch("http://localhost:8080/subscribe/subscribe.php", {
      method: 'POST',
      body: formData
    })
    .then(response => {
      if (!response.ok) {
        throw new Error("Network response was not ok " + response.statusText);
      }
      return response.json();
    })
    .then(data => {
      console.log("Response:", data);
      const resultDiv = document.getElementById('result');
      if (data.status === "success") {
        console.log(data.headers + data.body);
        window.location.href = "subscription_success.html"; // Redirect to success page
      } else if (data.status === "error") {
        resultDiv.innerText = data.message; // Display error message
      } else {
        resultDiv.innerText = "Unexpected status: " + data.status; // Handle unexpected status
      }
    })
    .catch(error => {
      console.error("Error:", error);
      document.getElementById('result').innerText = "An error occurred: " + error.message;
    });
  }
</script>

</html>
